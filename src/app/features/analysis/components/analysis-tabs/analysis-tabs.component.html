<div class="bg-gray-800 rounded-t-3xl -mx-5 -mb-9">
  <!-- Custom Tab Navigation -->
  <div class="p-4">
    <div class="custom-tab-container">
      <button
        class="custom-tab-button"
        [class.active]="activeTab() === 'ai-tips'"
        (click)="onTabChange('ai-tips')">
        –°–æ–≤–µ—Ç—ã –æ—Ç AI
      </button>
      <button
        class="custom-tab-button"
        [class.active]="activeTab() === 'expense-analysis'"
        (click)="onTabChange('expense-analysis')">
        –ê–Ω–∞–ª–∏–∑ —Ç—Ä–∞—Ç
      </button>
    </div>
  </div>

  <!-- Tab Content with Animation -->
  <div class="tab-content-wrapper">
    <div class="tab-content">
      @if (activeTab() === 'ai-tips') {
        <!-- AI Tips Content -->
        <div class="space-y-6">
          <!-- Money Options Section -->
          <div>
            <h2 class="text-white text-xl font-bold mb-4">–í–∞—Ä–∏–∞–Ω—Ç—ã –ø–æ–ª—É—á–µ–Ω–∏—è –¥–µ–Ω–µ–≥</h2>
            <p class="text-gray-300 text-sm mb-6">
              AI —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç: –û–ø—Ç–∏–º–∞–ª—å–Ω–æ –¥–ª—è –≤–∞—à–µ–π —Å–∏—Ç—É–∞—Ü–∏–∏. –ü–æ–∫—Ä–æ–µ—Ç –Ω–µ—Ö–≤–∞—Ç–∫—É –¥–æ –∑–∞—Ä–ø–ª–∞—Ç—ã.
            </p>

            <!-- Financial Products -->
            <div class="space-y-8">
              @if (data().recommendations && data().recommendations!.length > 0) {
                @for (recommendation of data().recommendations!; track recommendation.product_type) {
                  <div class="rounded-2xl p-4 text-white" [class]="getCategoryBackgroundClass(recommendation.category)">
                    <div class="flex justify-between items-start">
                      <div class="flex-1">
                        <h3 class="text-lg font-semibold mb-2">{{ getProductDisplayName(recommendation.product_type) }}</h3>
                        <p class="text-sm mb-1">{{ recommendation.reasoning }}</p>
                        <div class="text-2xl font-bold mt-2">{{ formatCurrencySafely(recommendation.amount) }} —Å—É–º</div>
                        <p class="text-sm">–û–∂–∏–¥–∞–µ–º—ã–π –¥–æ—Ö–æ–¥: {{ getExpectedReturnText(recommendation.expected_cost_or_return, recommendation.product_type) }}</p>
                      </div>
                      <div class="text-4xl">{{ getProductIcon(recommendation.product_type) }}</div>
                    </div>
                  </div>
                }
              } @else {
                <!-- Fallback cards when no recommendations -->
                <div class="bg-sky-500 rounded-2xl p-4 text-white">
                  <div class="flex justify-between items-start">
                    <div class="flex-1">
                      <h3 class="text-lg font-semibold mb-2">–ú–∏–∫—Ä–æ–∑–∞–π–º</h3>
                      <p class="text-sm mb-1">3% –≤ –º–µ—Å—è—Ü</p>
                      <p class="text-sm">–ù–∞ 12 –¥–Ω–µ–π - –ø–µ—Ä–µ–ø–ª–∞—Ç–∞ 18 000 —Å—É–º</p>
                      <div class="text-2xl font-bold mt-2">1 500 000 —Å—É–º</div>
                    </div>
                    <div class="text-4xl">ü™ô</div>
                  </div>
                </div>

                <div class="bg-orange-500 rounded-2xl p-4 text-white">
                  <div class="flex justify-between items-start">
                    <div class="flex-1">
                      <h3 class="text-lg font-semibold mb-2">–û–≤–µ—Ä–¥—Ä–∞—Ñ—Ç</h3>
                      <p class="text-orange-100 text-sm mb-1">–ü–æ –∑–∞—Ä–ø–ª–∞—Ç–Ω–æ–π –∫–∞—Ä—Ç–µ</p>
                      <p class="text-orange-100 text-sm">2.5% –≤ –º–µ—Å—è—Ü</p>
                      <div class="text-2xl font-bold mt-2">2 000 000 —Å—É–º</div>
                    </div>
                    <div class="text-4xl">üåç</div>
                  </div>
                </div>

                <div class="bg-green-600 rounded-2xl p-4 text-white">
                  <div class="flex justify-between items-start">
                    <div class="flex-1">
                      <h3 class="text-lg font-semibold mb-2">–ö—Ä–µ–¥–∏—Ç–Ω–∞—è –∫–∞—Ä—Ç–∞</h3>
                      <p class="text-green-100 text-sm">–°–∫–æ—Ä–∏–Ω–≥ –æ–¥–æ–±—Ä–∏–ª 20 –º–ª–Ω</p>
                      <div class="text-2xl font-bold mt-2">20 000 000 —Å—É–º</div>
                    </div>
                    <div class="text-4xl">üå±</div>
                  </div>
                </div>
              }
            </div>
          </div>
        </div>
      } @else if (activeTab() === 'expense-analysis') {
        <!-- Expense Analysis Content -->
        <div class="space-y-6">
          <h2 class="text-white text-xl font-bold">–ê–Ω–∞–ª–∏–∑ –¥–æ—Ö–æ–¥–æ–≤ –∏ —Ç—Ä–∞—Ç</h2>

          <!-- Income and Expenses List -->
          <div class="space-y-4">
            <!-- Salary Income -->
            @if (data().salary) {
              <div class="bg-gray-700 rounded-2xl p-4">
                <div class="flex justify-between items-center">
                  <div class="flex items-center space-x-3">
                    <div class="w-8 h-8 bg-gray-600 rounded-full flex items-center justify-center">
                      <span class="text-white text-sm">‚Üì</span>
                    </div>
                    <div>
                      <h3 class="text-white font-medium">–ó–∞—Ä–ø–ª–∞—Ç–∞</h3>
                      <p class="text-gray-400 text-sm">–û—Å–Ω–æ–≤–Ω–æ–π –¥–æ—Ö–æ–¥</p>
                    </div>
                  </div>
                  <div class="text-right">
                    <div class="text-green-400 font-semibold">+ {{ formatCurrency(data().salary!) }} —Å—É–º</div>
                    <div class="text-gray-400 text-sm">–°—Ç–∞–±–∏–ª—å–Ω–æ</div>
                  </div>
                </div>
              </div>
            }

            <!-- Expenses from API -->
            @if (data().expenses && data().expenses!.length > 0) {
              @for (expense of data().expenses!; track expense.name) {
                <div class="bg-gray-700 rounded-2xl p-4">
                  <div class="flex justify-between items-center">
                    <div class="flex items-center space-x-3">
                      <div class="w-8 h-8 bg-gray-600 rounded-full flex items-center justify-center">
                        <span class="text-white text-sm">‚Üë</span>
                      </div>
                      <div>
                        <h3 class="text-white font-medium">{{ expense.name }}</h3>
                        <p class="text-gray-400 text-sm">{{ expense.percentage.toFixed(1) }}% –æ—Ç –¥–æ—Ö–æ–¥–∞</p>
                      </div>
                    </div>
                    <div class="text-right">
                      <div class="text-red-400 font-semibold">- {{ formatCurrency(expense.amount) }} —Å—É–º</div>
                      <div class="text-gray-400 text-sm">{{ expense.percentage.toFixed(1) }}% –æ—Ç –¥–æ—Ö–æ–¥–∞</div>
                    </div>
                  </div>
                </div>
              }
            } @else {
              <!-- Fallback expenses when no data -->
              <div class="bg-gray-700 rounded-2xl p-4">
                <div class="flex justify-between items-center">
                  <div class="flex items-center space-x-3">
                    <div class="w-8 h-8 bg-gray-600 rounded-full flex items-center justify-center">
                      <span class="text-white text-sm">‚Üë</span>
                    </div>
                    <div>
                      <h3 class="text-white font-medium">–ê—Ä–µ–Ω–¥–∞</h3>
                      <p class="text-gray-400 text-sm">–ö–≤–∞—Ä—Ç–∏—Ä–∞ –≤ —Ü–µ–Ω—Ç—Ä–µ</p>
                    </div>
                  </div>
                  <div class="text-right">
                    <div class="text-red-400 font-semibold">- 2 000 000 —Å—É–º</div>
                    <div class="text-gray-400 text-sm">23% –æ—Ç –¥–æ—Ö–æ–¥–∞</div>
                  </div>
                </div>
              </div>

              <div class="bg-gray-700 rounded-2xl p-4">
                <div class="flex justify-between items-center">
                  <div class="flex items-center space-x-3">
                    <div class="w-8 h-8 bg-gray-600 rounded-full flex items-center justify-center">
                      <span class="text-white text-sm">‚Üë</span>
                    </div>
                    <div>
                      <h3 class="text-white font-medium">–†–∞–∑–≤–ª–µ—á–µ–Ω–∏—è</h3>
                      <p class="text-gray-400 text-sm">–ö–∏–Ω–æ</p>
                    </div>
                  </div>
                  <div class="text-right">
                    <div class="text-red-400 font-semibold">- 1 500 000 —Å—É–º</div>
                    <div class="text-gray-400 text-sm">18% –æ—Ç –¥–æ—Ö–æ–¥–∞</div>
                  </div>
                </div>
              </div>

              <div class="bg-gray-700 rounded-2xl p-4">
                <div class="flex justify-between items-center">
                  <div class="flex items-center space-x-3">
                    <div class="w-8 h-8 bg-gray-600 rounded-full flex items-center justify-center">
                      <span class="text-white text-sm">‚Üë</span>
                    </div>
                    <div>
                      <h3 class="text-white font-medium">–ê–≤—Ç–æ –∏ –ø—Ä–æ—á–µ–µ</h3>
                      <p class="text-gray-400 text-sm">–ë–µ–Ω–∑–∏–Ω</p>
                    </div>
                  </div>
                  <div class="text-right">
                    <div class="text-red-400 font-semibold">- 800 000 —Å—É–º</div>
                    <div class="text-gray-400 text-sm">9% –æ—Ç –¥–æ—Ö–æ–¥–∞</div>
                  </div>
                </div>
              </div>
            }
          </div>

          <!-- AI Expense Analysis -->
          <div class="bg-blue-600 rounded-2xl p-4 text-white">
            <div class="flex justify-between items-start mb-3">
              <h3 class="text-lg font-semibold">AI –∞–Ω–∞–ª–∏–∑ —Ç—Ä–∞—Ç</h3>
              <div class="text-2xl">üìä</div>
            </div>
            <ul class="space-y-2 text-sm">
              <li>‚Ä¢ {{ getExpenseAnalysisText() }}</li>
              <li>‚Ä¢ –¢—Ä–∞—Ç—ã —Å–æ—Å—Ç–∞–≤–ª—è—é—Ç {{ getExpensePercentage() }}% –æ—Ç –¥–æ—Ö–æ–¥–∞</li>
              <li>‚Ä¢ –ù–µ—Ç –¥–æ–ª–≥–æ–≤ –∏ –∫—Ä–µ–¥–∏—Ç–æ–≤</li>
              <li>‚Ä¢ –°—Ç–∞–±–∏–ª—å–Ω—ã–π —Ä–æ—Å—Ç –Ω–∞–∫–æ–ø–ª–µ–Ω–∏–π</li>
              <li>‚Ä¢ –û–ø—Ç–∏–º–∞–ª—å–Ω–æ–µ —Å–æ–æ—Ç–Ω–æ—à–µ–Ω–∏–µ –¥–æ—Ö–æ–¥—ã</li>
            </ul>
          </div>

          <!-- Future Tips -->
          <div class="bg-green-600 rounded-2xl p-4 text-white">
            <div class="flex justify-between items-start mb-3">
              <h3 class="text-lg font-semibold">–°–æ–≤–µ—Ç—ã –¥–ª—è –±—É–¥—É—â–µ–≥–æ</h3>
              <div class="text-2xl">üí°</div>
            </div>
            <p class="text-green-100 text-sm mb-3">–ü–ª–∞–Ω—ã –Ω–∞ —Ä–∞–∑–≤–∏—Ç–∏–µ</p>
            <ul class="space-y-2 text-sm">
              @for (tip of getFutureTips(); track tip) {
                <li>{{ tip }}</li>
              }
            </ul>
          </div>
        </div>
      }
    </div>
  </div>
</div>
